<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/png" href="favicon.png">
  <link rel="stylesheet" href="styles.css">
  <title>Group 15 Mobile Booth</title>
</head>
<body>
  <nav class="navbar">
    <a href="home.html" id="home">Home</a>
    <ul id="menu">
      <li><a href="login.html" id="login">Log In</a></li>
      <li><a href="faq.html">FAQ</a></li>
      <li><a href="about.html">About Us</a></li>
    </ul>
  </nav>

  <div class="task-page">
    <header>
      <h1>Mobile Booth</h1>
    </header>
    
    <main>
      <section class="webcam-section">
        <div class="webcam-container">
          <video id="webcam-video" class="webcam-video" autoplay playsinline></video>
          
          <div class="filter-container">
            <div class="select-container">
              <label class="select-label">Filter</label>
              <div class="select-button" id="filter-select">
                <span class="select-value">No Filter</span>
                <span class="select-chevron">‚ñº</span>
              </div>
              <div class="select-options" id="filter-options">
                <div class="select-option selected" data-value="none">No Filter</div>
                <div class="select-option" data-value="grayscale">Grayscale</div>
                <div class="select-option" data-value="sepia">Sepia</div>
                <div class="select-option" data-value="invert">Invert</div>
                <div class="select-option" data-value="blur">Blur</div>
                <div class="select-option" data-value="brightness">Brightness</div>
              </div>
            </div>
          </div>
          
          <div class="webcam-controls">
            <button id="startWebcam">Start Camera</button>
            <button id="captureImage" disabled>Take Photo</button>
            <button id="toggleVideoMode">Toogle Video Mode</button>
          </div>
          
          <div class="image-preview" id="image-preview" >
            <img id="captured-image" alt="Captured Image" class="captured-image" src="assets/placeholder.jpeg">
            <!-- Share Button -->
            <button id="shareButton">
              üåê Share
            </button>
            <!-- share button end -->
          </div>
        </div>
      </section>
    </main>
  </div>

  <script>
    // DOM Elements
    const video = document.getElementById('webcam-video');
    const startButton = document.getElementById('startWebcam');
    const captureButton = document.getElementById('captureImage');
    const imagePreview = document.getElementById('image-preview');
    const filterSelect = document.getElementById('filter-select');
    const filterOptions = document.getElementById('filter-options');
    
    // Variables
    let stream = null;
    let isActive = false;
    let currentFilter = 'none';
    
    // Event Listeners
    startButton.addEventListener('click', toggleWebcam);
    captureButton.addEventListener('click', captureImage);
    filterSelect.addEventListener('click', toggleFilterOptions);
    
    // Select each filter option
    const options = document.querySelectorAll('.select-option');
    options.forEach(option => {
      option.addEventListener('click', () => {
        // Update selected class
        options.forEach(opt => opt.classList.remove('selected'));
        option.classList.add('selected');
        
        // Update display text
        filterSelect.querySelector('.select-value').textContent = option.textContent;
        
        // Apply filter
        const filter = option.getAttribute('data-value');
        applyFilter(filter);
        
        // Close dropdown
        filterOptions.classList.remove('active');
        filterSelect.classList.remove('active');
      });
    });
    
    // Toggle webcam function
    async function toggleWebcam() {
      if (!isActive) {
        try {
          stream = await navigator.mediaDevices.getUserMedia({
            video: true,
            audio: false
          });
          
          video.srcObject = stream;
          isActive = true;
          startButton.textContent = 'Stop Camera';
          captureButton.disabled = false;
        } catch (error) {
          console.error('Error accessing webcam:', error);
          alert('Could not access the camera. Please ensure it is connected and permissions are granted.');
        }
      } else {
        stopWebcam();
        startButton.textContent = 'Start Camera';
        captureButton.disabled = true;
      }
    }
    
    // Stop webcam function
    function stopWebcam() {
      if (stream) {
        stream.getTracks().forEach(track => track.stop());
        stream = null;
      }
      
      video.srcObject = null;
      isActive = false;
    }
    
    // Toggle filter dropdown
    function toggleFilterOptions() {
      filterOptions.classList.toggle('active');
      filterSelect.classList.toggle('active');
    }
    
    // Apply filter function
    function applyFilter(filter) {
      currentFilter = filter;
      
      // Reset filter
      video.style.filter = '';
      
      // Apply selected filter
      switch (filter) {
        case 'grayscale':
          video.style.filter = 'grayscale(100%)';
          break;
        case 'sepia':
          video.style.filter = 'sepia(100%)';
          break;
        case 'invert':
          video.style.filter = 'invert(100%)';
          break;
        case 'blur':
          video.style.filter = 'blur(5px)';
          break;
        case 'brightness':
          video.style.filter = 'brightness(150%)';
          break;
      }
    }
    
    // Capture image function
    function captureImage() {
      if (!isActive) return;
      
      const canvas = document.createElement('canvas');
      const context = canvas.getContext('2d');
      
      // Set canvas dimensions to match video
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      
      // Draw current video frame to canvas
      if (context) {
        context.drawImage(video, 0, 0, canvas.width, canvas.height);
        
        // Apply filter to canvas if needed
        if (currentFilter !== 'none') {
          context.filter = video.style.filter;
          context.drawImage(canvas, 0, 0);
          context.filter = 'none';
        }
        
        // Convert canvas to data URL
        const imageDataURL = canvas.toDataURL('image/png');
        
        // Display the captured image
        displayCapturedImage(imageDataURL);
      }
    }
    
    // Display captured image
    function displayCapturedImage(imageDataURL) {
      // Clear previous previews
      imagePreview.innerHTML = '';
      
      // Create and display the image
      const img = document.createElement('img');
      img.src = imageDataURL;
      img.classList.add('captured-image');
      imagePreview.appendChild(img);
    }
    
    // Handle page unload
    window.addEventListener('beforeunload', () => {
      if (stream) {
        stream.getTracks().forEach(track => track.stop());
      }
    });
  </script>
</body>
</html> 